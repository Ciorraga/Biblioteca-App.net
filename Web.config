<?xml version="1.0" encoding="utf-8"?>

<!-- 
   Para autenticación mediante formularios,
   poner la etiqueta de la cabecera configuration así.
-->
<configuration xmlns="http://schemas.microsoft.com/.NetConfiguration/v2.0">

    <!-- Cadenas de conexión-->
    <connectionStrings>
        <add name="AdmConnectionString" connectionString="Data Source=(local);Initial Catalog=Administracion;Integrated Security=True"
            providerName="System.Data.SqlClient" />
        <add name="SqlServices" connectionString="Data Source=(local);Initial Catalog=aspnetdb;Integrated Security=SSPI;" />
        <add name="BibliotecaConnectionString" connectionString="Data Source=(local);Initial Catalog=Biblioteca;Integrated Security=True"
            providerName="System.Data.SqlClient" />
    </connectionStrings>

    <system.web>
        <compilation debug="false" targetFramework="4.0" />

        <!--
            La sección <authentication> habilita la configuración
            del modo de autenticación de seguridad utilizado por 
            ASP.NET para identificar a un usuario entrante. En nuestro
            caso autenticación mediante formularios
        -->
        <authentication mode="Forms">
            <forms loginUrl="Login.aspx" name=".ASPXFORMSAUTH" />
        </authentication>

        <!-- Los usuarios no autenticados no tienen acceso a esta aplicación -->
        <authorization>
           <deny users="?"/>
        </authorization>

        <!-- Habilitación de la característica de la administración de funciones. -->
        <roleManager defaultProvider="SqlProvider" enabled="true" cacheRolesInCookie="true" cookieName=".ASPROLES" cookieTimeout="30" cookiePath="/" cookieRequireSSL="false" cookieSlidingExpiration="true" cookieProtection="All">
           <providers>
               <!-- ¡¡¡Ojo!!!. Establecer el nombre de la aplicación-->
               <add name="SqlProvider" type="System.Web.Security.SqlRoleProvider" connectionStringName="SqlServices" applicationName="EjemploAutenticacion"/>
           </providers>
        </roleManager>
        <membership defaultProvider="SqlProvider" userIsOnlineTimeWindow="15">
           <providers>
                <!-- ¡¡¡Ojo!!!. Establecer el nombre de la aplicación-->
                <add name="SqlProvider" type="System.Web.Security.SqlMembershipProvider" connectionStringName="SqlServices" applicationName="EjemploAutenticacion"/>
           </providers>
        </membership>
    </system.web>

  <!-- Concesion de permisos a roles -->
  <location path="contenidos/administrador">
    <system.web>
      <authorization>
        <!-- se concede permiso al rol Administrador y se deniega al resto-->
        <allow roles="Administrador"/>
        <deny users="*"/>
      </authorization>
    </system.web>
  </location>
  <location path="contenidos/alumnos">
    <system.web>
      <authorization>
        <allow roles="Alumnado"/>
        <deny users="*"/>
      </authorization>
    </system.web>
  </location>
  <location path="contenidos/direccion">
    <system.web>
      <authorization>
        <allow roles="Dirección"/>
        <deny users="*"/>
      </authorization>
    </system.web>
  </location>
  <location path="contenidos/empresa">
    <system.web>
      <authorization>
        <allow roles="Empresa"/>
        <deny users="*"/>
      </authorization>
    </system.web>
  </location>
  <location path="contenidos/jd">
    <system.web>
      <authorization>
        <allow roles="Jefatura de Departamento"/>
        <deny users="*"/>
      </authorization>
    </system.web>
  </location>
  <location path="contenidos/tutord">
    <system.web>
      <authorization>
        <allow roles="Tutoría Docente"/>
        <deny users="*"/>
      </authorization>
    </system.web>
  </location>
  <location path="contenidos/tutorl">
    <system.web>
      <authorization>
        <allow roles="Tutoría Laboral"/>
        <deny users="*"/>
      </authorization>
    </system.web>
  </location>
  <location path="contenidos/tutorg">
    <system.web>
      <authorization>
        <allow roles="Tutoría de Grupo"/>
        <deny users="*"/>
      </authorization>
    </system.web>
  </location>
  <location path="contenidos/anonimo">
    <system.web>
      <authorization>
        <!-- Acceso a todos los usurios-->
        <allow users="*"/>
      </authorization>
    </system.web>
  </location>
</configuration>
